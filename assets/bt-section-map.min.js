theme.Maps=function(){var i=14,t=null,a=[],s={addressNoResults:theme.strings.addressNoResults,addressQueryLimit:theme.strings.addressQueryLimit,addressError:theme.strings.addressError,authError:theme.strings.authError},e='[data-section-type="map"]',r="[data-map]",o="[data-map-overlay]",n="map-section--load-error",d="map-section__error errors text-center";function l(e){if(this.$container=$(e),this.$map=this.$container.find(r),this.$overlay=this.$container.find(o),this.key=this.$map.data("api-key"),void 0!==this.key){var s=this.$map;BT.loadCssJsLib("waypoint",function(){s.waypoint(function(e){s.hasClass("working")||(s.addClass("working"),"loaded"===t?this.createMap():(a.push(this),"loading"!==t&&(t="loading",void 0===window.google&&$.getScript("https://maps.googleapis.com/maps/api/js?key="+this.key).then(function(){t="loaded",$.each(a,function(e,s){s.createMap()})}))))}.bind(this),{triggerOnce:!0,offset:"100%"})}.bind(this))}}return window.gm_authFailure=function(){Shopify.designMode&&($(e).addClass(n),$(r).remove(),$(o).after('<div class="'+d+'">'+theme.strings.authError+"</div>"))},l.prototype=_.assignIn({},l.prototype,{createMap:function(){var r=this.$map,o=this.$overlay;return BT.loadCssJsLib("googleMaps"),function(e){var t=$.Deferred(),s=new google.maps.Geocoder,a=e.data("address-setting");return s.geocode({address:a},function(e,s){s!==google.maps.GeocoderStatus.OK&&t.reject(s),t.resolve(e)}),t}(r).then(function(e){var s={zoom:i,center:e[0].geometry.location,draggable:!0,clickableIcons:!0,scrollwheel:!1,disableDoubleClickZoom:!1,disableDefaultUI:!0},t=this.map=new google.maps.Map(r[0],s),a=this.center=t.getCenter();new google.maps.Marker({map:t,position:t.getCenter()});google.maps.event.addDomListener(window,"resize",$.debounce(250,function(){google.maps.event.trigger(t,"resize"),t.setCenter(a),r.removeAttr("style")})),r.removeClass("working"),o.hide()}.bind(this)).fail(function(){var e;switch(r.removeClass("working"),status){case"ZERO_RESULTS":e=s.addressNoResults;break;case"OVER_QUERY_LIMIT":e=s.addressQueryLimit;break;case"REQUEST_DENIED":e=s.authError;break;default:e=s.addressError}Shopify.designMode&&r.parent().addClass(n).html('<div class="'+d+'">'+e+"</div>")})},onUnload:function(){0!==this.$map.length&&google.maps.event.clearListeners(this.map,"resize")}}),l}(),theme.sections.constructors.map=theme.Maps;